SELECT COUNT(DISTINCT TCM.POLICY_CODE) 笔数,SUM(TPB.FEE_AMOUNT) 总金额
   FROM DEV_PAS.T_CONTRACT_MASTER TCM,
        DEV_PAS.T_PERSISTENCE_BONUS TPB 
WHERE 1=1
   AND TCM.POLICY_ID = TPB.POLICY_ID
   AND TPB.PROCESS_STATUS = 1 --交易成功
   AND TCM.ORGAN_CODE LIKE '8647%'
   AND TPB.PAY_DUE_DATE = DATE '2012-09-26' --支付日期
   

SELECT TCM.POLICY_CODE,SUM(TPB.FEE_AMOUNT)
   FROM DEV_PAS.T_CONTRACT_MASTER TCM,
        DEV_PAS.T_PERSISTENCE_BONUS TPB 
WHERE 1=1
   AND TCM.POLICY_ID = TPB.POLICY_ID
   AND TPB.PROCESS_STATUS = 1 --交易成功
   AND TCM.ORGAN_CODE LIKE '8647%'
   AND TPB.PAY_DUE_DATE = DATE '2012-09-26' --支付日期
GROUP BY TCM.POLICY_CODE 
ORDER BY TCM.POLICY_CODE;
   
SELECT COUNT(DISTINCT A.CONTNO) 笔数,SUM(A.MONEY) 总金额
  FROM LIS.LCINSUREACCTRACE A
   AND FEECODE IN ('904004','905002','903004','907002','907007','907008','909002','909007') 
 WHERE PAYDATE > DATE '2017-12-26'
       AND A.ContNo IN (SELECT CONTNO
                      FROM LIS.LCPOL B
                     WHERE B.CONTTYPE = '1'
                       AND B.MANAGECOM LIKE '8647%')
       AND A.VALUEDATE = DATE '2012-09-26' --实际支付日期
       
SELECT A.CONTNO,SUM(A.MONEY)
  FROM LIS.LCINSUREACCTRACE A
   WHERE FEECODE IN ('904004','905002','903004','907002','907007','907008','909002','909007') 
  AND PAYDATE > DATE '2017-12-26'
       AND A.CONTNO IN (SELECT CONTNO
                      FROM LIS.LCPOL B
                     WHERE B.CONTTYPE = '1'
                       AND B.MANAGECOM LIKE '8647%')
       AND A.VALUEDATE = DATE '2012-09-26' --实际支付日期
 GROUP BY A.CONTNO
 ORDER BY A.CONTNO;
 
 SELECT TRIM(T2.POLICY_CODE) AS POLICY_CODE,
       TRIM(T1.CONTNO) AS CONTNO,
       (CASE WHEN T2.FEE_AMOUNT = T1.MONEY THEN
          '否'
         ELSE
          '是'
       END) AS RESULT1
  FROM TMP_LIS_1009_GB T1
  FULL JOIN TMP_NCS_1009_GB@DB_185 T2
    ON TRIM(T1.CONTNO) = TRIM(T2.POLICY_CODE)
 ORDER BY T2.POLICY_CODE;
