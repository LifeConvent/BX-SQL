SELECT COUNT(DISTINCT B.POLICY_ID) 笔数,
       SUM(B.CASH_BONUS) 现金红利,
       SUM(B.REISSUE_INTEREST) 补发利息
  FROM DEV_PAS.T_BONUS_ALLOCATE B
  LEFT JOIN DEV_PAS.T_CONTRACT_PRODUCT TCP
    ON TCP.POLICY_ID = B.POLICY_ID
 WHERE B.BONUS_ALLOT = 4
   AND TCP.ORGAN_CODE LIKE '8647%' --机构编号
   AND B.ALLOCATE_DATE = TO_DATE('2017/06/02', 'YYYY/MM/DD'); --分配日期

   
SELECT TCP.APPLY_CODE,B.BONUS_ALLOT,SUM(B.CASH_BONUS),SUM(B.REISSUE_INTEREST)
  FROM DEV_PAS.T_BONUS_ALLOCATE B
  LEFT JOIN DEV_PAS.T_CONTRACT_PRODUCT TCP
    ON TCP.POLICY_ID = B.POLICY_ID
 WHERE B.BONUS_ALLOT = 4
   AND TCP.ORGAN_CODE LIKE '8647%' --机构编号
   AND B.ALLOCATE_DATE = TO_DATE('2017/06/02', 'YYYY/MM/DD') --分配日期
GROUP BY TCP.APPLY_CODE,B.BONUS_ALLOT
ORDER BY TCP.APPLY_CODE,B.BONUS_ALLOT;
   
SELECT COUNT(DISTINCT A.POLNO) 笔数,
       SUM(A.CASHBONUS) 现金红利,
       SUM(A.BONUSINTEREST) 补发利息
       FROM LIS.LOAMEBONUSPOL A
       WHERE 1=1
       AND A.PAYMODE = '1' --现金分红 方式待定
       AND A.POLNO IN (SELECT CONTNO
                      FROM LIS.LCPOL B
                     WHERE B.CONTTYPE = '1'
                       AND B.MANAGECOM LIKE '8647%')
       AND A.BONUSMAKEDATE = DATE '2012-09-26' --分红日期
       
SELECT A.POLNO,
      (CASE WHEN A.PAYMODE = '1' THEN '4'
               ELSE A.PAYMODE
       END) AS PAYMODE,SUM(A.CASHBONUS),SUM(A.BONUSINTEREST)
       FROM LIS.LOAMEBONUSPOL A
       WHERE 1=1
       AND A.PAYMODE = '1' --现金分红 方式待定
       AND A.POLNO IN (SELECT CONTNO
                      FROM LIS.LCPOL B
                     WHERE B.CONTTYPE = '1'
                       AND B.MANAGECOM LIKE '8647%')
       AND A.BONUSMAKEDATE = DATE '2012-09-26' --分红日期
GROUP BY A.POLNO,PAYMODE
ORDER BY A.POLNO,PAYMODE;
       
SELECT TRIM(T2.POLICY_CODE) AS POLICY_CODE,
       TRIM(T1.CONTNO) AS CONTNO,
       (CASE WHEN TO_CHAR(T2.BONUS_ALLOT) = T1.PAYMODE THEN
          '否'
         ELSE
          '是'
       END) AS RESULT1
  FROM TMP_LIS_1008_GB T1
  FULL JOIN TMP_NCS_1008_GB@DB_185 T2
    ON TRIM(T1.CONTNO) = TRIM(T2.POLICY_CODE)
 ORDER BY T2.POLICY_CODE;
